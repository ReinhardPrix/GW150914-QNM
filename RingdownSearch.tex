\documentclass[aps,prd,onecolumn,nofootinbib,superscriptaddress,altaffilletter,floatfix]{revtex4-1}

%\documentclass[twocolumn,superscriptaddress,showpacs,preprintnumbers,amsmath,amssymb]{revtex4}
%\documentclass[,showpacs,preprintnumbers,amsmath,amssymb]{revtex4}

%\bibliographystyle{unsrt}
%ieeetr
\usepackage{graphicx}% Include figure files
\usepackage{float}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{longtable}
\usepackage{color}
\usepackage{hyperref}

% Bibliography style
%%\bibliographystyle{abbrvnat}
\bibliographystyle{apsrev}

\usepackage{soul}
\newcommand{\repr}[1]{{\color{red}[#1]}}
\newcommand{\strike}[1]{{\color{red}\st{#1}}}

\input{definitions.tex}
\input{git_tag.tex}
\begin{document}

\title{Bayesian Ringdown Search}

%% \title{Template-based investigations to study the parameter-space metric for known continuous
%% wave sources in binary systems}

\author{Reinhard Prix}
\altaffiliation{reinhard.prix@aei.mpg.de}
\affiliation{Max-Planck-Institut f\"ur Gravitationsphysik, Albert-Einstein-Institut, D-30167 Hannover, Germany}
\date{\commitDATE; \commitIDshort-\commitSTATUS}
%\parbox[c]{1em}{\textcolor{red}{DRAFT}}


\begin{abstract}
  ...
\end{abstract}

%%\pacs{04.80.Nn, 95.55.Ym, 95.75.-z, 97.60.Gb, 07.05.Kf}% PACS, the Physics and Astronomy
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{Intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Signal model: damped sinusoid starting at $\tStart$:
\begin{align}
  \label{eq:1}
  s(t;\,A, \phi_0\,, \tStart, \tau, f) &= A\,w(\Dt,\,\tau)\,\cos\left(2\pi f \Dt + \phi_0\right)\,,\\
  \Dt & \equiv t - \tStart\,\\
  w(\Dt, \tau) &=
  \begin{cases}
    \exp\left( -\frac{\Dt}{\tau} \right) & \text{if } \Dt \ge 0\,\\
    0  & \text{if } \Dt < 0
  \end{cases}
\end{align}
Rewrite waveform in terms of two unknown amplitudes $\As = -A\,\sin\phi_0,\,\Ac = A\,\cos\phi_0$ \cite{bretthorst1988:_bayesian_spectrum}:
\begin{equation}
  \label{eq:2}
  s(t; \parmsAll) = w(\Dt,\tau)\, \left[ \As\,\sin\left(2\pi f \Dt\right) + \Ac\,\cos\left(2\pi f \Dt\right) \right]\,,
\end{equation}
with the set of signal parameters
\begin{equation}
  \label{eq:11}
  \parmsAll \equiv \{\As,\Ac, \parmsEvol\}\,,\quad \parmsEvol \equiv \{\tStart,\tau, f\}\,.
\end{equation}
The likelihoods for Gaussian (colored) noise $\HypG$ and the ringdown model $\HypS$ are
\begin{align}
  \label{eq:4}
  \prob{x}{\HypG} &= c\,e^{-\frac{1}{2}\scalar{x}{x}}\,,\\
  \prob{x}{\HypS,\parmsAll} &= c\,e^{-\frac{1}{2}\scalar{x-s(\parmsAll)}{x-s(\parmsAll)}}\,,
\end{align}
with the multi-detector scalar product (over detector index $X$) defined as
\begin{equation}
  \label{eq:5}
  \scalar{x}{y}\equiv \sum_{X} \scalar{x^X}{y^X} = \sum_X 2\int_{-\infty}^{\infty} \frac{\FT{x}^X(f)\,\FT{y}^{*X}(f)}{S_X(f)}\,df\,,
\end{equation}
with the per-detector single-sided noise PSD $S_X(f)$ (which results in the prefactor of '2').
The (marginal) likelihood for the signal model can be expressed as
\begin{equation}
  \label{eq:6}
  \prob{x}{\HypS} = \int \prob{x}{\HypS,\parmsAll}\,\prob{\parmsAll}{\HypS}\,d\parmsAll\,,
\end{equation}
and the corresponding Bayes factor (or marginal likelihood ratio)
\begin{equation}
  \label{eq:7}
  \BSG(x) \equiv \frac{\prob{x}{\HypS}}{\prob{x}{\HypG}} = \int \Lr(x;\parmsAll)\,\prob{\parmsAll}{\HypS}\,d\parmsAll\,,
\end{equation}
with the likelihood-ratio \emph{function}
\begin{equation}
  \label{eq:8}
  \Lr(x;\parmsAll) \equiv \frac{\prob{x}{\HypS,\parmsAll}}{\prob{x}{\HypG}} = \exp\left(\scalar{x}{s} - \frac{1}{2}\scalar{s}{s}\right)\,.
\end{equation}

\section{Computing the Bayes factor $\BSG$}
\label{sec:comp-bayes-fact}


\subsection{Expressing the SNR$^2$: $\scalar{s}{s}$}
\label{sec:computing-scalarss}
Given that aLIGO noise-curve is relatively ``white'' over a broad-band in the ``bucket'', and the signal $s(t)$ of Eq.~\eqref{eq:1} can still be
considered relatively ``narrow band'' ($\sim \pm 100\Hz$) with respect to this noise curve, we can approximate the signal-normalization integral as
\begin{align}
  \label{eq:17}
  \scalar{s}{s} &= \sum_X 2 \int_{-\infty}^{\infty} \frac{\FT{s}^X(f)\,\FT{s}^{*X}(f)}{S_X(f)}\,d f\\
  &\sim \sum_X \frac{2}{S_X(f')} \, \int_{0}^{\infty} s^2(t;\parmsAll)\,dt\\
  &= 2\left( \As^2\,\Is + 2\As\Ac\,\Isc + \Ac^2\,\Ic \right)\, \sum_X \frac{1}{S_X(f')}\,,
\end{align}
where $f'$ is some (unknown) frequency within the effective frequency band around the central signal frequency $f$ (using mean-value theorem), and we
have used the assumption of identical signal model in both detectors (after time-shifting the data and correcting for antenna-pattern differences).
The respective integrals to compute are
\begin{align}
  \label{eq:18}
  \Is &\equiv \int_0^\infty e^{-\frac{2t}{\tau}}\,\sin^2(2\pi f t)\,dt = \frac{1}{2\pi f}\int e^{-\frac{\varphi}{Q}} \sin^2\!\varphi\,d\varphi\\
  \Ic &\equiv \int_0^\infty e^{-\frac{2t}{\tau}}\,\cos^2(2\pi f t)\,dt = \frac{1}{2\pi f}\int e^{-\frac{\varphi}{Q}} \cos^2\!\varphi\,d\varphi\\
  \Isc &\equiv \int_0^\infty e^{-\frac{2t}{\tau}}\,\sin(2\pi f t)\cos(2\pi f t)\,dt = \frac{1}{4\pi f}\int e^{-\frac{\varphi}{Q}} \sin2\varphi\,d\varphi\,,
\end{align}
using the definitions
\begin{align}
  \label{eq:3}
  \varphi &\equiv 2\pi f \Dt\,,\\
  Q       &\equiv \pi f \tau\,.
\end{align}
Assuming only non-critically damped signals, i.e. $Q\gtrsim \Ord{\pi}$, these integrals can be approximated computed analytically as [move to
appendix?]
\begin{align}
  \label{eq:19}
  \Is &= \left. \frac{-1}{2\pi f}\frac{Q^2}{1 + 4Q^2}e^{-\frac{\varphi}{Q}}\left[ \sin2\varphi + 2Q + \frac{\sin^2\varphi}{Q}\right]\right|_0^\infty\\
  &= \frac{2Q}{2\pi f}\,\frac{Q^2}{1+4Q^2} \stackrel{Q\gtrsim\pi}{\approx} \frac{Q}{4\pi f} = \frac{\tau}{4}\,,\\
  \Ic &= \left. \frac{-1}{2\pi f}\frac{Q^2}{1 + 4Q^2}e^{-\frac{\varphi}{Q}}\left[ -\sin2\varphi + 2Q + \frac{\cos^2\varphi}{Q}\right]\right|_0^\infty\\
  &= \frac{2Q + \frac{1}{Q}}{2\pi f}\,\frac{Q^2}{1+4Q^2} \stackrel{Q\gtrsim\pi}{\approx} \frac{Q}{4\pi f} = \frac{\tau}{4}\,,\\
  \Isc &= \left. \frac{-1}{2\pi f}\frac{Q^2}{1 + 4Q^2}e^{-\frac{\varphi}{Q}}\left[ 2\cos^2\varphi - 1 + \frac{\sin2\varphi}{2Q}\right]\right|_0^\infty\\
  &= \frac{1}{2\pi f}\,\frac{Q^2}{1+4Q^2} \stackrel{Q\gtrsim\pi}{\approx} \frac{1}{8\pi f} \sim \frac{1}{2Q}\,\Is \ll \Is \approx 0\,.
\end{align}
So we finally obtain the (perfect-match) SNR$^2$ as
\begin{align}
  \label{eq:20}
  \rho_0^2 \equiv \scalar{s}{s} &= \left(\As^2 + \Ac^2\right)\frac{\tau}{2}\sum_X \frac{1}{S_X(f)}\\
  &=\left(\As^2 + \Ac^2\right)\,\frac{\Ndet\tau}{2\Sn(f)}\,,
\end{align}
with the harmonic mean $\Sn^{-1} \equiv \frac{1}{\Ndet}\sum_X S_X^{-1}$.


\subsection{Expressing the ``matched filter'' $\scalar{x}{s(\parmsAll)}$}
\label{sec:computing-scalarxs}

Note that in the scalar product involving the data $x^X$ we can absorb the frequency-dependend noise-floors $S_X(f)$ by \emph{over-whitening} the
data, ie define
\begin{equation}
  \label{eq:12}
  \FT{y}^X \equiv \frac{\FT{x}^X(f)}{S_X(f)}\,,
\end{equation}
which allows us to write the scalar product in time-domain form
\begin{align}
  \label{eq:13}
  \scalar{x}{s(\parmsAll)} &= \sum_X 2\int_{-\infty}^{\infty} \FT{y}^X(f)\,\FT{s}^{*X}(f)\,df \\
  &= \sum_X 2\int_{-\infty}^{\infty} y^X(t)\,s^X(t)\,dt \\
  &= \sum_X 2\int_{\tStart}^{\tStart + T} y^X(t)\,s^X(t)\,dt\,,
\end{align}
where $T \gg \tau$ is some duration long enough so that $s(\tStart+T)\approx0$, e.g.\ $T=5\tau$. Here we define $t$ to the arrival time in one of
the detectors, 'H1', say. We further assume that we applied the detector-specific time-delay ($+7.3\ms$ for L1 in the case of GW150914) and
antenna-pattern corrections (a factor of $-1$ of L1 wrt H1) to the \emph{data} $y^X(t)$, such that we can assume the putative signal waveform in the
data to be in phase and of (approximately) same amplitude. This means that we can assume a detector-independent template $s^X(t) = s(t)$ (here
referring to H1 arrival time and phase).

Using Eq.~\eqref{eq:2} we can further write
\begin{equation}
  \label{eq:9}
  \scalar{x}{s(\parmsAll)} = \As\,\xs(\parmsEvol) + \Ac\,\xc(\parmsEvol)\,,
\end{equation}
with $\xs=\sum_X \xs^X$, $\xc=\sum_X \xc^X$, and
\begin{align}
  \label{eq:10}
  \xs^X(\parmsEvol) &\equiv 2\int_{0}^{T} y^X(\tStart+\Dt)\,e^{-\frac{\Dt}{\tau}}\sin(2\pi f\Dt)\,d\Dt,\\
  \xc^X(\parmsEvol) &\equiv 2\int_{0}^{T} y^X(\tStart+\Dt)\,e^{-\frac{\Dt}{\tau}}\cos(2\pi f\Dt)\,d\Dt.\\
\end{align}
Note that
\begin{align}
  \label{eq:16}
  \Fab^X \equiv (\xc - i\xs)^X &= 2 \int_{0}^{T} y^X(\tStart+\Dt)\,e^{-\Dt \,\varpi}\,d\Dt\,,
\end{align}
is the Laplace transform with complex frequency
\begin{equation}
  \label{eq:27}
  \varpi \equiv \frac{1}{\tau} + i2\pi f\,.
\end{equation}

\subsection{Marginalizing over unknown amplitudes $\{\As,\Ac\}$}
\label{sec:marg-over-unkn}

Combining these expressions in the likelihood-ratio function of Eq.~\eqref{eq:8}, and using $\Ndet=2$, we obtain
\begin{align}
  \label{eq:21}
  \ln \Lr(x;\parmsAll) &= \scalar{x}{s} - \frac{1}{2}\scalar{s}{s}\\
  &= -\frac{1}{2}\,\frac{\tau}{\Sn}\left(\As^2+\Ac^2\right) + \As\,\xs + \Ac\,\xc\,,
\end{align}
i.e.\ a 2-dimensional Gaussian in $\{\As,\Ac\}$, which can be integrated analytically for a suitable choice of prior.
For unknown amplitude and initial phase, we can consider a simple isotropic (ie uniform in phase $\phi_0$) Gaussian prior, with
characteristic amplitude scale $H$, i.e.\
\begin{equation}
  \label{eq:22}
  \prob{\A}{\HypS} = \frac{1}{2\pi\,H^2}\,e^{-\frac{1}{2H^2}\left(\As^2 + \Ac^2\right)}\,,
\end{equation}
which implies a (marginalized over $\phi_0$) prior on the amplitude $A$:
\begin{equation}
  \label{eq:28}
  \prob{A}{\HypS} = \frac{A}{H^2}\,e^{-\frac{A^2}{2H^2}}\,.
\end{equation}
We introduce the partially-marginalized (over unknown amplitude $A$ and phase $\phi_0$, i.e.\ $\As,\Ac$) Bayes factor $\BSG(x;\parmsEvol)$ as
\begin{align}
  \label{eq:23}
  \BSG(x) &= \int \BSG(x;\parmsEvol) \,\prob{\parmsEvol}{\HypS}\,d\parmsEvol\,,\\
  \BSG(x;\parmsEvol) &\equiv \int \Lr(x;\A,\parmsEvol)\prob{\A}{\HypS}\,d^2\A\,.
\end{align}

Using the above Gaussian prior we find
\begin{align}
  \label{eq:29}
  \BSG(x;\parmsEvol) &= \frac{1}{2\pi H^2}\int \exp\left[-\frac{1}{2}\,\Gam(\parmsEvol)\,\left(\As^2+\Ac^2\right) + \As\,\xs(\parmsEvol) + \Ac\,\xc(\parmsEvol)\right]\,d^2\A\\
  &=\frac{\Gam(\parmsEvol)}{H^2} \, \exp\left[\frac{\Gam(\parmsEvol)}{2}\left(\xs^2(\parmsEvol) + \xc^2(\parmsEvol)\right)\right]\,,
\end{align}
with
\begin{equation}
  \label{eq:25}
  \Gam^{-1}(\parmsEvol) \equiv \frac{\tau}{\Sn(f)} + \frac{1}{H^2} = \frac{H^2}{1 + \frac{H^2\tau}{\Sn(f)}}\,,
\end{equation}

Alternatively, for relatively well-constrained amplitude $A^{\sig}$ and phase $\phi_0^\sig$ parameters, one could simply use $\prob{\A}{\HypS} = \delta(\As-\As^\sig)\delta(\Ac-\Ac^\sig)$ and obtain
\begin{equation}
  \label{eq:24}
  \BSG(x;\parmsEvol) = \Lr(x;\A^\sig,\phi_0^\sig,\,\parmsEvol)\,.
\end{equation}

\section{Parameter estimation}
\label{sec:parameter-estimation}

The posterior is
\begin{align}
  \label{eq:30}
  \prob{\parmsAll}{x,\HypS} &\propto \prob{x}{\HypS,\parmsAll}\,\prob{\parmsAll}{\HypS}\\
    &\propto \Lr(x;\parmsAll)\,\prob{\A}{\HypS}\,\prob{\parmsEvol}{\HypS}\\
    &\propto \exp\left[-\frac{1}{2}\,\Gam(\parmsEvol)\,\left(\As^2+\Ac^2\right) + \As\,\xs(\parmsEvol) + \Ac\,\xc(\parmsEvol)\right]\,\prob{\parmsEvol}{\HypS}\,.
\end{align}
where in the first line we have dropped the $\parmsAll$-independent normalization $1/\prob{x}{\HypS}$, and in the second line $\prob{x}{\HypG}$.



\bibliography{RingdownSearch}

\end{document}

%%% Local Variables:
%%% ispell-local-dictionary: "american"
%%% fill-column: 150
%%% mode: latex
%%% mode: flyspell
%%% TeX-master: t
%%% End:
